<!DOCTYPE html>
<html lang="en">
  <head>
    {% load static %}

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% load static %}
    <head>
      <title>C-DAC Chennai - System & Security Services</title>
      <link
        rel="icon"
        type="image/x-icon"
        href="{% static 'img/cdaclogo.png' %}"
      />
    </head>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}" />

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <style>
      /* General Styles */
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f1f1f1; /* Light background for the page */
        min-height: 100vh; /* Ensure body covers the viewport */
        display: flex;
        flex-direction: column;
      }

      header {
        background-color: #007bff; /* Bootstrap primary blue */
        color: white;
        padding: 20px 0;
        text-align: center;
        margin-left: 0px;
        position: relative;
      }

      .logo {
        position: absolute;
        top: 5px;
        left: 370px;
        width: 140px; /* Adjust size as needed */
        height: auto;
        transition: transform 0.3s ease-in-out, opacity 0.3s;
        cursor: pointer;
      }

      .logo:hover {
        transform: scale(1.1); /* Slight zoom effect */
        opacity: 0.8; /* Fade effect */
      }

      h1 {
        margin: 0;
        font-size: 2rem;
      }

      /* Navigation Bar */
      nav {
        background-color: #343a40; /* Footer-like dark background */
        color: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        padding: 10px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .nav-link {
        font-size: 1.1rem;
        color: white; /* White text for nav links */
        font-weight: bold;
        text-decoration: none;
        margin-left: 20px;
      }

      .nav-link:first-child {
        margin-left: 100px; /* For the first link, add more margin */
      }

      .nav-link:hover {
        color: #ffc107; /* Gold color on hover */
        text-decoration: underline;
      }

      /* Sidebar Styles */
      aside {
        background-color: #f8f9fa;
        border-right: 1px solid #ddd;
        padding: 16px;
        width: 250px;
        position: absolute;
        left: 0;
        top: 160px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        min-height: calc(100vh - 136px); /* Adjust to match the page layout */
        bottom: 0;
      }

      aside ul {
        padding: 0;
        margin: 0;
        list-style: none;
      }

      aside ul li {
        margin-bottom: 10px;
      }

      aside ul li a {
        text-decoration: none;
        font-size: 1rem;
        color: #007bff;
        display: block;
        padding: 8px 12px;
        border-radius: 4px;
      }

      aside ul li a:hover {
        background-color: #007bff;
        color: white;
      }

      .home-link {
        text-decoration: none;
        font-size: 1rem;
        color: #007bff;
        display: block;
        padding: 8px 12px;
        border-radius: 4px;
        transition: background-color 0.3s, color 0.3s;
      }

      .home-link:hover {
        background-color: #007bff;
        color: white;
      }

      /* Toggle Button Styles */
      #checkbox2 {
        display: none;
      }

      /* Main Content Area */
main {
  margin-left: 165px; /* Adjust according to sidebar width */
  width: 1237.5px; /* Set the width manually */
  height: 570px; /* Set the height manually */
  padding: 20px;
  background-color: #ffffff;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  
}


      article {
        min-height: calc(
          100vh - 60px - 195px
        ); /* Adjust to fill the page minus header/footer */
        padding: 20px;
      }

      /* Footer */
      footer {
        text-align: center;
        padding: 10px 20px;
        background-color: #343a40; /* Footer-like dark background */
        color: white;
        margin-top: 0px;
        margin-left: 0px;
      }

      /* Scroll to Top Button */
      #scrollTopBtn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        text-align: center;
        line-height: 40px;
        font-size: 18px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      #scrollTopBtn:hover {
        background-color: #0056b3;
      }

      /* User Profile Dropdown */
      .dropdown-menu {
        width: 250px;
      }

      .dropdown-menu .dropdown-item {
        font-size: 0.9rem;
        color: #333;
      }

      .dropdown-menu .dropdown-item.text-danger {
        color: #dc3545;
      }

      .nav-separator {
        width: 2px;
        height: 30px;
        background-color: #ccc;
        margin: 0 15px;
        align-self: center;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        aside {
          width: 100%;
          position: absolute;
          min-height: auto;
          margin-top: 145px;
        }

        .logo {
          left: 0%;
          width: 135px;
        }

        main {
          width: 91%;
          margin-left: 160px; /* Full width for small screens */
          padding: 15px;
          height: auto;
        }

        nav {
          flex-direction: column; /* Stacks links vertically */
          align-items: center; /* Centers links */
        }
      
        .nav-link {
          width: 100%; /* Full width for better fit */
          text-align: center;
        }
      }

      #calendarContainer {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      /* Ensures calendar cells and dates are fully visible */
      .fc-day-number {
        font-size: 14px;
        padding: 5px;
      }

      .fc-header-toolbar {
        margin-bottom: 10px;
      }

      .fc-header-title h2 {
        font-size: 18px;
        font-weight: bold;
      }

      /* Make sure the calendar header is visible */
      .fc-toolbar .fc-left,
      .fc-toolbar .fc-center,
      .fc-toolbar .fc-right {
        flex: 1;
      }

      /* Custom styles for user profile dropdown */
      #userProfileDropdown {
        position: relative;
      }

      .dropdown-menu {
        min-width: 200px;
      }

      .dropdown-item {
        padding: 12px 20px;
      }

      .dropdown-item:hover {
        background-color: #f8f9fa; /* Light background on hover */
        cursor: pointer;
      }

      .dropdown-item a {
        color: #dc3545; /* Red color for logout link */
      }

      .dropdown-item a:hover {
        color: #fff; /* White color on hover for logout link */
        background-color: #dc3545;
      }

      .dropdown-item .fa {
        margin-right: 10px; /* Add space before the icon */
      }

      /* Profile picture styling */
      .dropdown-item img {
        border-radius: 50%;
      }

      .text-center img {
        border: 3px solid #ddd;
      }

      .text-center h5 {
        margin-top: 10px;
        color: #007bff; /* Blue color for the username */
      }

      /* Center the avatar container */
.avatar-container {
    display: flex;
    justify-content: center; /* Centers horizontally */
    align-items: center; /* Centers vertically */
    width: 100%; /* Full width */
    padding: 10px 0; /* Add spacing if needed */
}

/* Avatar image styling */
.avatar-image {
    height: 75px;
    background: transparent;
    border: none;
    box-shadow: none;
    border-radius: 50%;
}

    </style>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
  </head>
  <body>
    
    <header>
      {% load static %}
      <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
          <img
            src="{% static 'img/cdaclogo.png' %}"
            alt="C-DAC Logo"
            class="img-fluid"
            style="height: 70px"
          />
          <span
            class="ml-3 text-white font-weight-bold"
            style="font-size: 35px"
          >
            C-DAC Chennai - System & Security Services
          </span>
        </div>
        <div class="ml-auto">
          <a href="#navigation" class="text-white mr-3">Skip to navigation</a> |
          <a href="#main-content" class="text-white mr-3"
            >Skip to main content</a
          >
          |
          <a href="#" class="text-white mr-3">हिन्दी</a>
          <button id="themeToggle" class="btn btn-sm btn-light ml-3">Dark Mode</button>
        </div>
      </div>
    </header>


    <script>
      document.getElementById("themeToggle").addEventListener("click", function () {
        document.body.classList.toggle("dark-mode");
      });
    </script>
    
    <style>
      /* General Dark Mode Styles */
.dark-mode {
  background-color: #121212;
  color: white;
}

/* Navbar Styles */
.dark-mode .navbar {
  background-color: #003366;
}

.dark-mode .navbar-brand,
.dark-mode .nav-link {
  color: white !important;
}

/* Sidebar Styles */
.dark-mode aside {
  background-color: #002244; /* Dark navy blue */
  border-right: 2px solid #004488; /* Slightly lighter border */
  color: white;
}

.dark-mode aside ul li a {
  color: white;
}

.dark-mode aside ul li a:hover {
  background-color: #004488;
  color: white;
}

/* Main Content */
.dark-mode main {
  background-color: #121212;
  color: white;
  padding: 20px;
}

/* Article Styles */
.dark-mode article {
  background-color: #1a1a1a;
  color: white;
  padding: 20px;
  border-radius: 8px;
  border: 1px solid #333;
}

/* Dashboard Content */
.dark-mode .dashboard-content {
  background-color: #121212;
  color: white;
}

/* Buttons and Links */
.dark-mode a {
  color: #1e90ff; /* Bright blue for better contrast */
}

.dark-mode a:hover {
  color: #00bfff;
}

/* Forms */
.dark-mode input,
.dark-mode textarea,
.dark-mode select {
  background-color: #333;
  color: white;
  border: 1px solid #555;
}

.dark-mode input::placeholder,
.dark-mode textarea::placeholder {
  color: #bbb;
}

    </style>

    <nav
      id="navigation"
      class="d-flex justify-content-between align-items-center"
    >
      <!-- Dropdown Menus for Home, About, and Contact -->

      <!-- Dropdown Menus for Home, About, Contact, Services, and Downloads -->
      <div class="d-flex justify-content-center w-100">
        <!-- Home Dropdown -->
        <div class="dropdown" style="margin-left: 0px">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            type="button"
            id="homeDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Home
          </button>
          <ul class="dropdown-menu" aria-labelledby="homeDropdown">
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'home1' %}"
                >Home Submenu 1</a
              >{% else %}<a class="dropdown-item restricted" href="home1"
                >Home Submenu 1</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'home2' %}"
                >Home Submenu 2</a
              >{% else %}<a class="dropdown-item restricted" href="home2"
                >Home Submenu 2</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'home3' %}"
                >Home Submenu 3</a
              >{% else %}<a class="dropdown-item restricted" href="home3"
                >Home Submenu 3</a
              >{% endif %}
            </li>
          </ul>
        </div>

        <!-- Vertical Separator -->
        <div class="nav-separator"></div>

        <!-- About Dropdown -->
        <div class="dropdown" style="margin-left: 10px">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            type="button"
            id="aboutDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            About
          </button>
          <ul class="dropdown-menu" aria-labelledby="aboutDropdown">
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'about_us' %}"
                >About Us</a
              >{% else %}<a class="dropdown-item restricted" href="about_us"
                >About Us</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'our_mission' %}"
                >Our Mission</a
              >{% else %}<a class="dropdown-item restricted" href="our_mission"
                >Our Mission</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'our_team' %}"
                >Our Team</a
              >{% else %}<a class="dropdown-item restricted" href="our_team"
                >Our Team</a
              >{% endif %}
            </li>
          </ul>
        </div>

        
        <!-- Vertical Separator -->
        <div class="nav-separator"></div>

        <!-- Services Dropdown -->
        <div class="dropdown" style="margin-left: 10px">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            type="button"
            id="servicesDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Services
          </button>
          <ul class="dropdown-menu" aria-labelledby="servicesDropdown">
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'service1' %}"
                >Internet Access</a
              >{% else %}<a class="dropdown-item restricted" href="service1"
                >Internet Access</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'service2' %}"
                >IP Whitelist</a
              >{% else %}<a class="dropdown-item restricted" href="service2"
                >IP Whitelist</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'service3' %}"
                >Public IP</a
              >{% else %}<a class="dropdown-item restricted" href="service3"
                >Public IP</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'service4' %}"
                >System</a
              >{% else %}<a class="dropdown-item restricted" href="service4"
                >system</a
              >{% endif %}
            </li>
          </ul>
        </div>

        <!-- Vertical Separator -->
        <div class="nav-separator"></div>

        <!-- Downloads Dropdown -->
        <div class="dropdown" style="margin-left: 10px">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            type="button"
            id="downloadsDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Downloads
          </button>
          <ul class="dropdown-menu" aria-labelledby="downloadsDropdown">
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'download1' %}"
                >Form 1</a
              >{% else %}<a class="dropdown-item restricted" href="download1"
                >Form 1</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'download2' %}"
                >Form 2</a
              >{% else %}<a class="dropdown-item restricted" href="download2"
                >Form 2</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'download3' %}"
                >Form 3</a
              >{% else %}<a class="dropdown-item restricted" href="download3"
                >Form 3</a
              >{% endif %}
            </li>
          </ul>
        </div>
        <!-- Vertical Separator -->
        <div class="nav-separator"></div>

        <!-- Contact Dropdown -->
        <div class="dropdown" style="margin-left: 10px">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            type="button"
            id="contactDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Contact
          </button>
          <ul class="dropdown-menu" aria-labelledby="contactDropdown">
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'email_us' %}"
                >Email Us</a
              >{% else %}<a class="dropdown-item restricted" href="email_us"
                >Email Us</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'call_us' %}"
                >Call Us</a
              >{% else %}<a class="dropdown-item restricted" href="call_us"
                >Call Us</a
              >{% endif %}
            </li>
            <hr class="dropdown-divider" />
            <li>
              {% if user.is_authenticated %}<a
                class="dropdown-item"
                href="{% url 'visit_us' %}"
                >Visit Us</a
              >{% else %}<a class="dropdown-item restricted" href="visit_us"
                >Visit Us</a
              >{% endif %}
            </li>
          </ul>
        </div>


        <!-- Vertical Separator -->
        <div class="nav-separator"></div>
      </div>

      <!-- Modal for Login Prompt -->
      <div
        id="loginModal"
        class="modal fade"
        tabindex="-1"
        aria-labelledby="loginModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="loginModalLabel">Login Required</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <p style="color: red; font-weight: bold">
                Kindly login to access this feature.
              </p>
              <button id="loadForm" class="btn btn-primary" style="width: 100%">
                Sign In
              </button>
            </div>
          </div>
        </div>
      </div>

      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
        $(document).ready(function () {
          // Function to get CSRF token from the cookies
          function getCSRFToken() {
            let csrfToken = null;
            const csrfCookie = document.cookie
              .split(";")
              .find((cookie) => cookie.trim().startsWith("csrftoken="));
            if (csrfCookie) {
              csrfToken = csrfCookie.split("=")[1];
            }
            return csrfToken;
          }

          // Store the clicked URL in a variable
          let clickedUrl = "";

          // Attach click event to dropdown items
          $(".dropdown-item").on("click", function (e) {
            e.preventDefault();

            // Update clickedUrl to the new clicked item's URL
            clickedUrl = $(this).attr("href");

            // Check if the clicked item has the "restricted" class (for unauthenticated users)
            if ($(this).hasClass("restricted")) {
              // Show the login modal
              $("#loginModal").modal("show");
            } else {
              // If the clicked item is not restricted, load the page content into #k1-article
              loadPageContent(clickedUrl);
            }
          });

          // Handle the login form submission
          $("#k1-article").on("submit", "form", function (e) {
            e.preventDefault();
            const formData = $(this).serialize(); // Serialize the form data

            // Get the CSRF token
            const csrfToken = getCSRFToken();

            $.ajax({
              url: "{% url 'my-login' %}", // Replace with your login URL
              method: "POST",
              data: formData,
              headers: {
                "X-CSRFToken": csrfToken, // Add CSRF token to the request headers
              },
              success: function (response) {
                if (response.redirect_url) {
                  // After login, check if we need to redirect after login
                  if (clickedUrl) {
                    // Load the clicked URL after login
                    loadPageContent(clickedUrl);
                  } else {
                    // If no specific URL was clicked, load the dashboard or default page
                    loadPageContent(response.redirect_url);
                  }
                } else {
                  // If the response includes the updated form, replace the content with errors
                  $("#k1-article").html(response.form_html);
                }
              },
              error: function () {
                alert("Error logging in. Please try again.");
              },
            });
          });

          // Handle click event on the "Sign In" button inside the modal
          $("#loadForm").on("click", function (e) {
            e.preventDefault();

            // Dynamically load the login form into the #k1-article div
            const url = "{% url 'my-login' %}"; // Replace 'my-login' with your Django login URL

            $.ajax({
              url: url,
              method: "GET",
              success: function (data) {
                // Load the login form into the content area
                $("#k1-article").html(data);
              },
              error: function () {
                alert("Error loading the login form. Please try again.");
              },
            });

            // Close the modal after the form is loaded
            $("#loginModal").modal("hide");
          });

          // Function to load page content dynamically into #k1-article
          function loadPageContent(url) {
            $.ajax({
              url: url,
              method: "GET",
              success: function (data) {
                // Inject the content into #k1-article
                $("#k1-article").html(data);
              },
              error: function () {
                $("#k1-article").html(
                  "<p>Error loading the page. Please try again.</p>"
                );
              },
            });
          }
        });
        
      </script>
      

      <!-- User Profile Section aligned to the right -->
<div class="dropdown">
  <button
    class="btn btn-light dropdown-toggle d-flex align-items-center p-2 shadow-sm rounded"
    type="button"
    id="userProfileDropdown"
    data-bs-toggle="dropdown"
    aria-expanded="false"
    style="border: 1px solid #ddd; min-width: 180px"
  >
    <img id="user-avatar" src="" alt="User Avatar" class="rounded-circle me-2" width="25" height="25">
    <span id="user-name" class="fw-bold">Guest</span>
  </button>
  <ul
    class="dropdown-menu dropdown-menu-end p-3 shadow-lg border-0"
    aria-labelledby="userProfileDropdown"
    style="width: 250px"
  >
    <div id="user-info" style="display: none;">
      <div class="avatar-container">
        <img id="user-profile-pic" src="" alt="User Avatar" class="avatar-image">
      </div>
      <h5 id="profile-username" class="fw-semibold text-center"></h5>
      <hr />
      <p class="mb-1"><strong>Username:</strong> <span id="profile-username-text"></span></p>
      <p class="mb-1">
        <strong>Staff Status:</strong>
        <span id="profile-staff-status" class="badge"></span>
      </p>
      <p class="mb-1"><strong>Email:</strong> <span id="profile-email"></span></p>
      <a class="dropdown-item text-danger text-center fw-bold p-2" href="{% url 'logout' %}"
        style="border-radius: 8px; background: #ffe6e6">
        <i class="fa fa-sign-out-alt"></i> Logout
      </a>
    </div>

    <!-- If not logged in -->
    <div id="guest-info" class="text-center text-danger fw-bold">
      <p class="mb-1">You are not logged in.</p>
      <a class="btn btn-primary mt-2" href="{% url 'my-login' %}" data-bs-toggle="modal" data-bs-target="#loginModal">Login</a>
    </div>
  </ul>
</div>

<script>
  function updateUserProfile() {
    fetch("{% url 'auth_status' %}")
      .then(response => response.json())
      .then(data => {
        if (data.is_authenticated) {
          // Show User Info
          document.getElementById("user-info").style.display = "block";
          document.getElementById("guest-info").style.display = "none";

          // Update username
          document.getElementById("user-name").textContent = data.username;
          document.getElementById("profile-username").textContent = data.username;
          document.getElementById("profile-username-text").textContent = data.username;

          // Update staff status
          const staffStatus = document.getElementById("profile-staff-status");
          staffStatus.textContent = data.is_staff ? "Yes" : "No";
          staffStatus.classList.add(data.is_staff ? "bg-success" : "bg-danger");

          // Update email
          document.getElementById("profile-email").textContent = data.email;

          // Update profile picture
          const userAvatar = document.getElementById("user-avatar");
          const profilePic = document.getElementById("user-profile-pic");

          if (data.profile_picture) {
            userAvatar.src = data.profile_picture;
            profilePic.src = data.profile_picture;
          } else {
            const defaultAvatar = data.gender === "Male" ? "{% static 'img/woman1.png' %}" : "{% static 'img/man.png' %}";
            userAvatar.src = defaultAvatar;
            profilePic.src = defaultAvatar;
          }
        } else {
          // Show Guest Info
          document.getElementById("user-info").style.display = "none";
          document.getElementById("guest-info").style.display = "block";

          // Reset to default guest user
          document.getElementById("user-name").textContent = "Guest";
          document.getElementById("user-avatar").src = "https://via.placeholder.com/30";
        }
      });
  }

  // Run the function when the page loads
  updateUserProfile();

  // Optional: Refresh authentication status every 5 seconds
  setInterval(updateUserProfile, 5000);
</script>

      <!-- Login Modal -->
      <div
        class="modal fade"
        id="loginModal"
        tabindex="-1"
        aria-labelledby="loginModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="loginModalLabel">Login</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <form method="POST" action="{% url 'my-login' %}">
                {% csrf_token %}
                <div class="mb-3">
                  <label for="username" class="form-label">Username</label>
                  <input
                    type="text"
                    class="form-control"
                    id="username"
                    name="username"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="password" class="form-label">Password</label>
                  <input
                    type="password"
                    class="form-control"
                    id="password"
                    name="password"
                    required
                  />
                </div>
                <button type="submit" class="btn btn-primary w-100">
                  Login
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <div class="container">
      <aside
        style="
          background-color: #f8f9fa;
          border-right: 1px solid #ddd;
          padding: 16px;
          width: 273.5px;
          min-height: calc(100vh - 60px - 195px);
          position: absolute;
          left: 0;
          top: 173px;
          overflow-y: auto;
          display: flex;
          flex-direction: column;
        "
      >
        <h3
          class="text-primary"
          style="text-align: center; margin-bottom: 10px"
        >
        <i class="fas fa-link"></i> Quick Links
        </h3>

        <!-- Search Bar -->
        <input
          type="text"
          id="quickLinksSearch"
          class="form-control mb-3"
          placeholder="🔍 Search Quick Links..."
          style="margin-bottom: 10px"
        />

        <script>
          $(document).ready(function () {
            $("#quickLinksSearch").on("keyup", function () {
              var value = $(this).val().toLowerCase();
              $("#quickLinksList li").filter(function () {
                $(this).toggle(
                  $(this).text().toLowerCase().indexOf(value) > -1
                );
              });
            });
          });
        </script>

        <!-- Quick Links (No toggle button) -->
        <div class="mt-2">
          <ul class="list-group" id="quickLinksList">
            <li class="list-group-item">
              <a
                href="#dashboard1"
                data-content="<h2>Dashboard</h2><p>Welcome to our dashboard!</p>"
              >
              <i class="fas fa-chart-line text-primary"></i> Dashboard
              </a>
            </li>

            <!-- Dropdown Menu for Home -->
            <li class="list-group-item dropdown">
              <a
                href="#"
                class="dropdown-toggle home-link"
                id="homeDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
              <i class="fas fa-home text-success"></i> Home
              </a>
              <ul class="dropdown-menu" aria-labelledby="homeDropdown">
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'home1' %}"
                    >Home Submenu 1</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="home1"
                    >Home Submenu 1</a
                  >
                  {% endif %}
                </li>
                <hr class="dropdown-divider" />
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'home2' %}"
                    >Home Submenu 2</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="home2"
                    >Home Submenu 2</a
                  >
                  {% endif %}
                </li>
                <hr class="dropdown-divider" />
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'home3' %}"
                    >Home Submenu 3</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="home3"
                    >Home Submenu 3</a
                  >
                  {% endif %}
                </li>
              </ul>
            </li>

            <!-- Dropdown Menu for Services -->
            <li class="list-group-item dropdown">
              <a
                href="#"
                class="dropdown-toggle home-link"
                id="servicesDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
              <i class="fas fa-tools text-warning"></i> Services
              </a>
              <ul class="dropdown-menu" aria-labelledby="servicesDropdown">

                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'service1' %}"
                    >Internet Access</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="service1"
                    >Internet Access</a
                  >
                  {% endif %}
                </li>
                
                <li>
                <hr class="dropdown-divider" />
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'service2' %}"
                    >IP Whitelist</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="service2"
                    >IP Whitelist</a
                  >
                  {% endif %}
                </li>
                <li>
                <hr class="dropdown-divider" />
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'service3' %}"
                    >Public IP</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="service3"
                    >Public IP</a
                  >
                  {% endif %}
                </li>
                <li>
                  <hr class="dropdown-divider" />
                  <li>
                    {% if user.is_authenticated %}
                    <a class="dropdown-item" href="{% url 'service4' %}"
                      >System</a
                    >
                    {% else %}
                    <a class="dropdown-item restricted" href="service4"
                      >System</a
                    >
                    {% endif %}
                  </li>
              </ul>
            </li>

            <!-- Dropdown Menu for Downloads -->
            <li class="list-group-item dropdown">
              <a
                href="#"
                class="dropdown-toggle home-link"
                id="downloadsDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
              <i class="fas fa-download text-info"></i> Downloads
              </a>
              <ul class="dropdown-menu" aria-labelledby="downloadsDropdown">
                <li>
                  
                  <li>
                    {% if user.is_authenticated %}
                    <a class="dropdown-item" href="{% url 'download1' %}"
                      >Download 1</a
                    >
                    {% else %}
                    <a class="dropdown-item restricted" href="download1"
                      >Download 1</a
                    >
                    {% endif %}
                  </li>
                  <li>
                    <hr class="dropdown-divider" />
                    <li>
                      {% if user.is_authenticated %}
                      <a class="dropdown-item" href="{% url 'download2' %}"
                        >Download 2</a
                      >
                      {% else %}
                      <a class="dropdown-item restricted" href="download2"
                        >Download 2</a
                      >
                      {% endif %}
                    </li>
                    <li>
                      <hr class="dropdown-divider" />
                      <li>
                        {% if user.is_authenticated %}
                        <a class="dropdown-item" href="{% url 'download3' %}"
                          >Download 3</a
                        >
                        {% else %}
                        <a class="dropdown-item restricted" href="download3"
                          >Download 3</a
                        >
                        {% endif %}
                      </li>
              </ul>
            </li>

            <!-- Contact Dropdown -->
            <li class="list-group-item dropdown">
              <a
                href="#"
                class="dropdown-toggle home-link"
                id="contactDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
              <i class="fas fa-phone-alt text-danger"></i> Contact
              </a>
              <ul class="dropdown-menu" aria-labelledby="contactDropdown">
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'email_us' %}"
                    >Email Us</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="email_us"
                    >Email Us</a
                  >
                  {% endif %}
                </li>
                <hr class="dropdown-divider" />
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'call_us' %}"
                    >Call Us</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="call_us">Call Us</a>
                  {% endif %}
                </li>
                <hr class="dropdown-divider" />
                <li>
                  {% if user.is_authenticated %}
                  <a class="dropdown-item" href="{% url 'visit_us' %}"
                    >Visit Us</a
                  >
                  {% else %}
                  <a class="dropdown-item restricted" href="visit_us"
                    >Visit Us</a
                  >
                  {% endif %}
                </li>
              </ul>
            </li>

            
               <!-- If logged in -->
  <li class="list-group-item" id="logoutSection" style="display: none;">
    <a id="logoutLink" class="dropdown-item text-danger text-center fw-bold p-2" 
       href="{% url 'logout' %}" >
      <i class="fa fa-sign-out-alt"></i> Logout
    </a>
  </li>

  <!-- If not logged in -->
  <li id="loginStatus" class="dropdown-item text-danger text-center fw-bold p-2">
    <p class="mb-1">You are not logged in.</p>
    
  </li>
            
            
            <script>
              function updateAuthStatus() {
                fetch("{% url 'auth_status' %}")
                  .then(response => response.json())
                  .then(data => {
                    if (data.is_authenticated) {
                      // Show Logout & Hide Login
                      document.getElementById("logoutSection").style.display = "block";
                      document.getElementById("loginStatus").style.display = "none";
                    } else {
                      // Hide Logout & Show Login
                      document.getElementById("logoutSection").style.display = "none";
                      document.getElementById("loginStatus").style.display = "block";
                    }
                  })
                  .catch(error => console.error("Error fetching auth status:", error));
              }
            
              // Run on page load
              updateAuthStatus();
            
              // Refresh every 5 seconds
              setInterval(updateAuthStatus, 5000);
            </script>

            <li class="list-group-item">
              <a href="#register" id="loadRegisterForm"><i class="fas fa-user-plus"></i> Register</a>
            </li>
            <li class="list-group-item">
              <a href="#login" id="loadLoginForm"><i class="fas fa-sign-in-alt"></i> Login</a>
            </li>
          </ul>
        </div>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
          function updateAuthStatus() {
            fetch("{% url 'auth_status' %}")
              .then(response => response.json())
              .then(data => {
                if (data.is_authenticated) {
                  // Show Logout Link & Hide Login Message
                  document.getElementById("logoutLink").style.display = "inline";
                  document.getElementById("loginStatus").style.display = "none";
                } else {
                  // Hide Logout Link & Show Login Message
                  document.getElementById("logoutLink").style.display = "none";
                  document.getElementById("loginStatus").style.display = "inline";
                }
              });
          }
        
          // Run the function when the page loads
          updateAuthStatus();
        
          // Optional: Refresh authentication status every 5 seconds
          setInterval(updateAuthStatus, 5000);
        </script>
        
        
        

        <!-- Sticky Add Event Form -->
        <!-- jQuery -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

        <script>
          $(document).ready(function () {
            

            // Initialize mini calendar
            createMiniCalendar();
          });

          function createMiniCalendar() {
            const date = new Date();
            const month = date.toLocaleString("default", { month: "long" });
            const year = date.getFullYear();
            $("#calendar-month").text(`${month} ${year}`);

            const daysContainer = $("#calendar-days");
            daysContainer.empty();

            const firstDay = new Date(year, date.getMonth(), 1).getDay();
            const lastDate = new Date(year, date.getMonth() + 1, 0).getDate();

            for (let i = 0; i < firstDay; i++) {
              daysContainer.append('<div class="day empty"></div>');
            }

            for (let day = 1; day <= lastDate; day++) {
              const todayClass = day === date.getDate() ? "today" : "";
              daysContainer.append(`<div class="day ${todayClass}">${day}</div>`);
            }
          }
        </script>
        <ul id="quickLinksList">
          <!-- Sticky Add Event Form -->
          <div>
            <div class="mt-3">
              <li><h4 class="text-secondary"><i class="fas fa-calendar-plus text-success me-2"></i>Add Event</h4>
              <form id="addEventForm">
                <div class="mb-2">
                  <label for="eventTitle" class="form-label">Event Title</label>
                  <input
                    type="text"
                    id="eventTitle"
                    class="form-control"
                    placeholder="Enter event title"
                    required
                  />
                </div>
                <div class="mb-2">
                  <label for="eventDate" class="form-label">Event Date</label>
                  <input
                    type="date"
                    id="eventDate"
                    class="form-control"
                    required
                  />
                </div>
                <div class="mb-2">
                  <label for="eventDescription" class="form-label"
                    >Description</label
                  >
                  <textarea
                    id="eventDescription"
                    class="form-control"
                    placeholder="Enter event description (optional)"
                  ></textarea>
                </div>
                <button type="submit" class="btn btn-success w-100">
                  ➕ Add Event
                </button>
              </form></li>

              <!-- Delete Event Section -->
              <li><h4 class="text-secondary mt-4"><i class="fas fa-calendar-times text-danger me-2"></i>Delete Event</h4>
              <form id="deleteEventForm">
                <div class="mb-2">
                  <label for="deleteEventTitle" class="form-label"
                    >Event Title</label
                  >
                  <input
                    type="text"
                    id="deleteEventTitle"
                    class="form-control"
                    placeholder="Enter title of the event to delete"
                    required
                  />
                </div>
                <div class="mb-2">
                  <label for="deleteEventDate" class="form-label"
                    >Event Date</label
                  >
                  <input
                    type="date"
                    id="deleteEventDate"
                    class="form-control"
                    required
                  />
                </div>
                <button type="submit" class="btn btn-danger w-100">
                  🗑️ Delete Event
                </button>
              </form></li>

              <!-- Events Container -->
              <li><h4 class="text-secondary mt-4"><i class="fas fa-newspaper text-info me-2"></i>Tips & News</h4>
              <div
                id="eventsContainer"
                style="height: auto; overflow-y: auto"
              ></div>
            </div></li>

            <!-- Mini Calendar -->
           <li> <h4 class="text-secondary mt-4"><i class="fas fa-calendar-alt text-warning me-2"></i>Mini Calendar</h4>
            <div class="calendar">
              <h5 id="calendar-month"></h5>
              <div class="days" id="calendar-days"></div>
            </div>
          </div>
        </ul></li>

        <!-- Styles for Mini Calendar -->
        <style>
          .calendar {
            width: 238px;
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
            background: #f9f9f9;
            border-radius: 5px;
          }
          .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
          }
          .day {
            padding: 5px;
            background: #fff;
            border-radius: 3px;
          }
          .today {
            background: #007bff;
            color: white;
            font-weight: bold;
          }
        </style>

        <!-- FullCalendar Library Integration (No longer needed) -->
        <link
          href="https://cdn.jsdelivr.net/npm/fullcalendar@3.3.0/dist/fullcalendar.min.css"
          rel="stylesheet"
        />
        <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.3.0/dist/fullcalendar.min.js"></script>

        <style>
          /* Message Box Container */
          #eventsContainer {
            padding: 20px;
            background: linear-gradient(135deg, #f9f9f9, #ffffff);
            border-radius: 12px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            height: auto;
            overflow-y: auto;
          }

          /* Individual Event Box */
          .eventBox {
            background: linear-gradient(45deg, #ff7eb3, #ff758c);
            color: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-weight: bold;
            overflow: hidden;
            white-space: nowrap;
          }

          /* Marquee Effect */
          .marquee {
            display: block;
            width: 100%;
            white-space: nowrap;
            overflow: hidden;
            box-sizing: border-box;
          }

          .marquee span {
            display: inline-block;
            animation: marqueeAnimation 10s linear infinite;
          }

          @keyframes marqueeAnimation {
            0% {
              transform: translateX(100%);
            }
            100% {
              transform: translateX(-100%);
            }
          }

          /* Hover Effect on Event Boxes */
          .eventBox:hover {
            transform: scale(1.05);
            box-shadow: 0px 3px 10px rgba(0, 0, 0, 0.2);
          }

          /* Button for adding events */
          .addEventButton {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
          }

          /* Hover effect for add event button */
          .addEventButton:hover {
            background: linear-gradient(45deg, #0056b3, #003580);
          }
        </style>

        <script>
          $(document).ready(function () {
            const eventsData = JSON.parse("{{ events_data|escapejs }}");

            // Container for events
            const eventsContainer = $("#eventsContainer");

            // Render each event as a message box with marquee and delete button
            eventsData.forEach(function (event) {
              const eventBox = $("<div class='eventBox'></div>");
              eventBox.attr("id", `event_${event.id}`); // Give each event a unique ID
              eventBox.html(`
                  <strong>${event.title}</strong><br>
                  <em>${event.date}</em><br>
                  <div class="marquee"><span>${
                    event.description || "No description available"
                  }</span></div>
                `);
              eventsContainer.append(eventBox);
            });

            // Add Event Form Submission
            $("#addEventForm").on("submit", function (e) {
              e.preventDefault();

              const title = $("#eventTitle").val();
              const date = $("#eventDate").val();
              const description = $("#eventDescription").val();

              if (title && date) {
                $.ajax({
                  url: '{% url "add_event" %}',
                  type: "POST",
                  data: JSON.stringify({ title, date, description }),
                  contentType: "application/json",
                  success: function (response) {
                    alert(response.message);

                    const newEventBox = $("<div class='eventBox'></div>");
                    newEventBox.attr("id", `event_${response.event.id}`);
                    newEventBox.html(`
                        <strong>${response.event.title}</strong><br>
                        <em>${response.event.date}</em><br>
                        <div class="marquee"><span>${
                          response.event.description ||
                          "No description available"
                        }</span></div>
                      `);
                    eventsContainer.append(newEventBox);

                    $("#addEventForm")[0].reset();
                  },
                  error: function () {
                    alert("An error occurred. Please try again.");
                  },
                });
              } else {
                alert("Please fill in the required fields (Title and Date).");
              }
            });

            // Delete Event Form Submission
            $("#deleteEventForm").on("submit", function (e) {
              e.preventDefault();

              const title = $("#deleteEventTitle").val();
              const date = $("#deleteEventDate").val();

              if (title && date) {
                $.ajax({
                  url: '{% url "delete_event" %}',
                  type: "POST",
                  data: JSON.stringify({ title, date }),
                  contentType: "application/json",
                  success: function (response) {
                    alert(response.message);
                    // Remove the event from the UI after successful deletion
                    $(`#eventsContainer .eventBox`).each(function () {
                      if (
                        $(this).find("strong").text().trim() === title &&
                        $(this).find("em").text().trim() === date
                      ) {
                        $(this).remove();
                      }
                    });
                  },
                  error: function () {
                    alert("An error occurred while deleting the event.");
                  },
                });
              } else {
                alert(
                  "Please fill in the Title and Date of the event to delete."
                );
              }
            });
          });
        </script>
      </aside>

      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
        $(document).ready(function () {
          // Function to get CSRF token from the cookies
          function getCSRFToken() {
            let csrfToken = null;
            const csrfCookie = document.cookie
              .split(";")
              .find((cookie) => cookie.trim().startsWith("csrftoken="));
            if (csrfCookie) {
              csrfToken = csrfCookie.split("=")[1];
            }
            return csrfToken;
          }

          // Store the clicked URL in a variable
          let clickedUrl = "";

          // Attach click event to dropdown items
          $(".dropdown-item").on("click", function (e) {
            e.preventDefault();

            // Update clickedUrl to the new clicked item's URL
            clickedUrl = $(this).attr("href");

            // Check if the clicked item has the "restricted" class (for unauthenticated users)
            if ($(this).hasClass("restricted")) {
              // Show the login modal
              $("#loginModal").modal("show");
            } else {
              // If the clicked item is not restricted, load the page content into #k1-article
              loadPageContent(clickedUrl);
            }
          });

          // Handle the login form submission
          $("#k1-article").on("submit", "form", function (e) {
            e.preventDefault();
            const formData = $(this).serialize(); // Serialize the form data

            // Get the CSRF token
            const csrfToken = getCSRFToken();

            $.ajax({
              url: "{% url 'my-login' %}", // Replace with your login URL
              method: "POST",
              data: formData,
              headers: {
                "X-CSRFToken": csrfToken, // Add CSRF token to the request headers
              },
              success: function (response) {
                if (response.redirect_url) {
                  // After login, check if we need to redirect after login
                  if (clickedUrl) {
                    // Load the clicked URL after login
                    loadPageContent(clickedUrl);
                  } else {
                    // If no specific URL was clicked, load the dashboard or default page
                    loadPageContent(response.redirect_url);
                  }
                } else {
                  // If the response includes the updated form, replace the content with errors
                  $("#k1-article").html(response.form_html);
                }
              },
              error: function () {
                alert("Error logging in. Please try again.");
              },
            });
          });

          // Handle click event on the "Sign In" button inside the modal
          $("#loadForm").on("click", function (e) {
            e.preventDefault();

            // Dynamically load the login form into the #k1-article div
            const url = "{% url 'my-login' %}"; // Replace 'my-login' with your Django login URL

            $.ajax({
              url: url,
              method: "GET",
              success: function (data) {
                // Load the login form into the content area
                $("#k1-article").html(data);
              },
              error: function () {
                alert("Error loading the login form. Please try again.");
              },
            });

            // Close the modal after the form is loaded
            $("#loginModal").modal("hide");
          });

          // Function to load page content dynamically into #k1-article
          function loadPageContent(url) {
            $.ajax({
              url: url,
              method: "GET",
              success: function (data) {
                $("#k1-article").html(data);
              },
              error: function () {
                alert("Error loading page content.");
              },
            });
          }
        });
      </script>

      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
        $(document).ready(function () {
          // Handle click event for the logout link
          $("#logoutLink").on("click", function (e) {
            e.preventDefault();

            // Make an AJAX request to log out the user
            $.ajax({
              url: '{% url "logout" %}', // The Django logout URL
              type: "POST", // POST request for logging out
              data: {
                csrfmiddlewaretoken: "{{ csrf_token }}", // Include the CSRF token in the request
              },
              success: function (response) {
                // If the logout is successful, load final.html dynamically into #k1-article
                $("#k1-article").load(
                  "{% url 'final' %}",
                  function (response, status, xhr) {
                    if (status == "error") {
                      alert("An error occurred while loading the final page.");
                    }
                  }
                );
              },
              error: function () {
                // Handle any errors that occur during the logout process
                
              },
            });
          });
        });
      </script>

      <main id="main-content">
        <article
          id="k1-article"
          style="
            height: 550px; /* Scrollable area */
            overflow-y: auto;
            margin-left:-17px;
            margin-top:-17px;
           
          "
        >
        <div class="card shadow-lg p-5 bg-white rounded position-relative"
     style="transition: transform 0.3s ease-in-out; border-left: 6px solid #006a9f;
            background: linear-gradient(135deg, rgba(0,106,159,0.1), rgba(255,255,255,0.9));">
  
  <!-- Animated Hover Effect -->
  <style>
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 106, 159, 0.2);
    }
    .btn-custom {
      transition: all 0.3s ease-in-out;
      font-size: 1.1rem;
    }
    .btn-custom:hover {
      transform: scale(1.07);
    }
    .highlight {
      background: linear-gradient(90deg, #006a9f);
      -webkit-background-clip: text;
      
    }
  </style>

  <!-- Header with Gradient -->
  <h2 class="card-title text-center mb-4 fw-bold"
      style="font-size: 2.5rem; font-family: 'Arial', sans-serif;">
      <img
            src="{% static 'img/cdaclogo.png' %}"
            alt="C-DAC Logo"
            class="img-fluid"
            style="height: 70px; background: transparent; border: none; box-shadow: none;" 
          />
      <span class="highlight"> Welcome to C-DAC Chennai System Security & Services</span>  
    <br> 
  </h2>

  <!-- Stylish Divider -->
  <div class="mx-auto mb-4" style="width: 100px; height: 5px; background: #006a9f; border-radius: 10px;"></div>

  <!-- Content -->
  <p class="card-text text-muted mb-4"
     style="font-size: 1.2rem; line-height: 1.8; text-align: justify;">
    <strong>Centre for Development of Advanced Computing (C-DAC) Chennai</strong> is a leading institution in  
    <span class="highlight">System Security and Services</span>, delivering next-gen solutions in **cybersecurity, digital forensics, network security, and cloud security frameworks**.  
    We specialize in safeguarding critical digital assets through:
  </p>

  <!-- Features with Modern Icons -->
  <ul class="list-unstyled text-muted" style="font-size: 1.2rem; line-height: 1.8;">
    <li><i class="fas fa-shield-alt text-primary"></i> <strong> Advanced Threat Intelligence:</strong> AI-driven detection & automated response.</li>
    <li><i class="fas fa-cloud"></i> 
      <strong> Secure Cloud & Data Protection:</strong> Blockchain encryption & zero-trust security.</li>
    <li><i class="fas fa-user-secret text-warning"></i> <strong> Digital Forensics & Incident Response:</strong> Cutting-edge forensic investigation tools.</li>
    <li><i class="fas fa-network-wired text-success"></i> <strong> Enterprise & Government Security:</strong> Tailored solutions for high-risk infrastructures.</li>
  </ul>

  <!-- Trust-Building CTA -->
  <p class="card-text text-muted text-center mt-4"
     style="font-size: 1.3rem; line-height: 1.8;">
    🏆 **Industry-Leading Security Solutions Trusted by Enterprises & Government Sectors.**  <br>
    💡 <strong>Partner with us</strong> for innovative security solutions that redefine digital protection.
  </p>

  <!-- CTA Buttons for Clients -->
  <div class="d-flex flex-column flex-md-row justify-content-center gap-3 mt-4">
    <a href="#explore" class="btn btn-primary btn-lg btn-custom rounded-pill px-5 py-3 shadow">
      🚀 Explore Solutions
    </a>
    <a href="#contact" class="btn btn-outline-danger btn-lg btn-custom rounded-pill px-5 py-3 shadow">
      📩 Schedule a Consultation
    </a>
  </div>
</div>


   
          <br />
        </article>
      </main>
    </div>
    
    <footer>
      <p>&copy; 2025 Centre for Development of Advanced Computing (CDAC). All rights reserved.</p>
     <!-- Chatbot Icon -->
<div id="chatbot-icon" onclick="toggleChatbot()">
  <i class="fas fa-comment-alt"></i>
</div>

<!-- Chatbot Window -->
<div id="chatbot-window">
  <div id="chatbot-header">
      <span>Chatbot</span>
      <div class="chatbot-header-buttons">
        <span id="help-btn" class="chatbot-btn" onclick="showChatbotCommands()">
            <i class="fa-solid fa-question-circle"></i> Help
        </span>
        <span id="clear-chat-btn" class="chatbot-btn" onclick="clearChat()">
            <i class="fa-solid fa-trash"></i> Clear Chat
        </span>
    </div>
    
      <button onclick="toggleChatbot()">✖</button>
  </div>
  
  <div id="chatbot-messages"></div>
  <!-- Chatbot Input & Voice Button -->
<div id="chatbot-input-container">
  <input type="text" id="chatbot-input" placeholder="Type a message..." onkeypress="sendMessage(event)">
  <button id="voice-btn" onclick="startVoiceRecognition()">
      <i class="fa-solid fa-microphone"></i>
  </button>
</div>

</div>
    </footer>

    <script>
      function toggleChatbot() {
          var chatbot = document.getElementById("chatbot-window");
          var input = document.getElementById("chatbot-input");
          var chatbox = document.getElementById("chatbot-messages");
      
          if (chatbot.style.display === "none" || chatbot.style.display === "") {
              chatbot.style.display = "flex"; // Show chatbot
              input.focus();
              loadChatHistory(); // Load previous messages
          } else {
              chatbot.style.display = "none"; // Hide chatbot
          }
      }
      
      function sendMessage(event) {
          if (event.key === "Enter") {
              var input = document.getElementById("chatbot-input");
              var message = input.value.trim();
              if (message === "") return;
      
              var chatbox = document.getElementById("chatbot-messages");
      
              // Add user message
              chatbox.innerHTML += `<div class="message user-message"><span>You:</span> ${message} <small>${getTime()}</small></div>`;
              saveChatHistory(); // Save message history
              input.value = "";
      
              chatbox.scrollTop = chatbox.scrollHeight;
      
              // Show typing indicator
              setTimeout(() => {
                  chatbox.innerHTML += `<div id="typing-indicator" class="message bot-message">Bot is typing...</div>`;
                  chatbox.scrollTop = chatbox.scrollHeight;
              }, 500);
      
              // Generate bot response
              setTimeout(() => {
                  document.getElementById("typing-indicator").remove(); // Remove typing indicator
                  var botResponse = generateBotResponse(message);
                  typeBotResponse(botResponse);
                  chatbox.scrollTop = chatbox.scrollHeight;
              }, 1500);
          }
      }
      
      // Function to generate bot responses
      function generateBotResponse(userMessage) {
          const responses = {
              "hello": ["Hi there! How can I assist you?", "Hello! What brings you here?", "Hey! How can I help?"],
              "hi": ["Hello! Need any help?", "Hey there! How can I assist?", "Hi! What do you need?"],
              "how are you": ["I'm just a bot, but I'm here to help!", "I don't have feelings, but I'm always ready to assist!", "I'm doing great! How about you?"],
              "bye": ["Goodbye! Have a great day!", "See you later! Take care!", "Bye! Stay safe!"],
              "what is your name": ["I'm your friendly chatbot!", "Just call me ChatBot!", "I'm a virtual assistant here to help."],
              "tell me a joke": ["Why did the scarecrow win an award? Because he was outstanding in his field!", "Why don’t skeletons fight each other? They don’t have the guts!", "What did one ocean say to the other ocean? Nothing, they just waved!"],
              "help": ["Sure! What do you need help with?", "I'm here to assist. Ask me anything!", "Tell me how I can assist you today."],
              "nav": ["Kindly Login to access the features."],
          };
      
          let lowerMessage = userMessage.toLowerCase();
      
          // Check if message exists in responses, else provide a fallback response
          if (responses[lowerMessage]) {
              return responses[lowerMessage][Math.floor(Math.random() * responses[lowerMessage].length)];
          } else {
              const defaultResponses = [
                  "I'm not sure, but I can try to help!",
                  "Could you please rephrase that?",
                  "That's interesting! Tell me more.",
                  "I might not have the answer, but I can try!",
              ];
              return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
          }
      }
      
      // Function to type the bot response letter by letter (Typing Effect)
      function typeBotResponse(text) {
          var chatbox = document.getElementById("chatbot-messages");
          var botMessage = document.createElement("div");
          botMessage.classList.add("message", "bot-message");
      
          var span = document.createElement("span");
          span.innerText = "Bot: ";
          botMessage.appendChild(span);
      
          var messageSpan = document.createElement("span");
          botMessage.appendChild(messageSpan);
      
          chatbox.appendChild(botMessage);
          chatbox.scrollTop = chatbox.scrollHeight;
      
          let i = 0;
          function typeText() {
              if (i < text.length) {
                  messageSpan.innerHTML += text.charAt(i);
                  i++;
                  setTimeout(typeText, 50); // Adjust speed of typing effect
              } else {
                  messageSpan.innerHTML += ` <small>${getTime()}</small>`;
                  speakResponse(text);
                  saveChatHistory(); // Save message history after full response
              }
          }
          typeText();
      }
      
      
      
      // Function to get current time
      function getTime() {
          let now = new Date();
          return now.getHours() + ":" + (now.getMinutes() < 10 ? "0" : "") + now.getMinutes();
      }
      
      // Function to save chat history in local storage
      function saveChatHistory() {
          localStorage.setItem("chatHistory", document.getElementById("chatbot-messages").innerHTML);
      }
      
      // Function to load chat history from local storage
      function loadChatHistory() {
          let chatHistory = localStorage.getItem("chatHistory");
          if (chatHistory) {
              document.getElementById("chatbot-messages").innerHTML = chatHistory;
          }
      }
      
      // Function to clear chat history
      function clearChat() {
          document.getElementById("chatbot-messages").innerHTML = "";
          localStorage.removeItem("chatHistory");
      }

      let recognition; // Global variable for speech recognition

function startVoiceRecognition() {
    if (!('webkitSpeechRecognition' in window)) {
        alert("Your browser does not support voice recognition.");
        return;
    }

    if (recognition) {
        recognition.stop(); // Stop recognition if already running
        recognition = null;
        document.getElementById("voice-btn").style.background = "red"; // Reset button color
        return;
    }

    recognition = new webkitSpeechRecognition();
    recognition.continuous = false;
    recognition.lang = "en-US";

    recognition.onresult = function(event) {
        var transcript = event.results[0][0].transcript;
        document.getElementById("voice-btn").style.background = "red"; // Reset button after recognition stops
        processVoiceMessage(transcript); // ✅ Convert speech to chatbot message
    };

    recognition.onend = function() {
        document.getElementById("voice-btn").style.background = "red"; // Ensure button resets
    };

    recognition.start();
    document.getElementById("voice-btn").style.background = "green"; // Change color while recording
}

// Function to handle voice message and add it to the chat
function processVoiceMessage(voiceMessage) {
    if (!voiceMessage.trim()) return;

    var chatbox = document.getElementById("chatbot-messages");

    // Add user message from voice input
    chatbox.innerHTML += `<div class="message user-message"><span>You:</span> ${voiceMessage} <small>${getTime()}</small></div>`;
    
    chatbox.scrollTop = chatbox.scrollHeight;
    saveChatHistory(); // Save message history

    // Show typing indicator
    setTimeout(() => {
        chatbox.innerHTML += `<div id="typing-indicator" class="message bot-message">Bot is typing...</div>`;
        chatbox.scrollTop = chatbox.scrollHeight;
    }, 500);

    // Generate bot response
    setTimeout(() => {
        document.getElementById("typing-indicator").remove(); // Remove typing indicator
        var botResponse = generateBotResponse(voiceMessage);
        typeBotResponse(botResponse);
        chatbox.scrollTop = chatbox.scrollHeight;
    }, 1500);
}

function showChatbotCommands() {
  var chatbox = document.getElementById("chatbot-messages");

  const commandsList = `
      <div class="message bot-message">
          <span>Bot:</span> Here are some commands you can use: <br><br>
          <b>• hello</b> - Greets you<br>
          <b>• how are you</b> - Checks bot status<br>
          <b>• what is your name</b> - Tells bot name<br>
          <b>• tell me a joke</b> - Bot tells a joke <br>
          <b>• bye</b> - Ends the chat<br>
          <b>• help</b> - Shows this list of commands<br>
      </div>
  `;

  chatbox.innerHTML += commandsList;
  chatbox.scrollTop = chatbox.scrollHeight;
}

      </script>
      
      <style>
        
      
        /* Chatbot Icon */
#chatbot-icon {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #007bff;
    color: white;
    font-size: 24px;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    transition: background 0.3s ease;
}
#chatbot-icon:hover {
    background: #0056b3;
}

/* Chatbot Window */
#chatbot-window {
    display: none;
    position: fixed;
    bottom: 80px;
    right: 20px;
    width: 300px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    flex-direction: column;
    z-index: 1000;
}

/* Chatbot Header */
#chatbot-header {
    background: #007bff;
    color: white;
    padding: 10px;
    font-size: 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
#chatbot-header button {
    background: transparent;
    border: none;
    color: white;
    font-size: 18px;
    cursor: pointer;
}

/* Chat Messages */
#chatbot-messages {
    height: 250px;
    padding: 10px;
    overflow-y: auto;
    background: #f9f9f9;
}
#chatbot-messages div {
    margin: 5px 0;
    padding: 8px;
    border-radius: 5px;
}
#chatbot-messages div:nth-child(odd) {
    background:  #007bff;
    text-align: left;
}
#chatbot-messages div:nth-child(even) {
    background: lightgreen;
    text-align: left;
}
/* Chatbot Input Area */
#chatbot-input-container {
    display: flex;
    align-items: center;
    padding: 10px;
    background: white;
}

/* Chatbot Input */
#chatbot-input {
    flex: 1; /* Takes full width */
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    outline: none;
}

/* Voice Button */
#voice-btn {
    background: #007bff;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 18px;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 10px; /* Space between input and button */
    transition: background 0.3s;
}

#voice-btn:hover {
    background: #0056b3;
}



      </style>
      

    <button id="scrollTopBtn" title="Go to top">↑</button>

    <script src="{% static 'js/script.js' %}"></script>

    <script>
      $(document).ready(function () {
        $("aside ul li a").on("click", function (event) {
          event.preventDefault();
          const newContent = $(this).data("content");
          $("#k1-article").html(newContent);
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#loadRegisterForm").on("click", function (event) {
          event.preventDefault();
          $.ajax({
            url: '{% url "register" %}', // URL for the registration form
            type: "GET",
            success: function (data) {
              $("#k1-article").html(data); // Load the registration form content into the article

              // Attach a submit event listener to the dynamically loaded form
              $("#k1-article").on("submit", "form", function (e) {
                e.preventDefault();
                const formData = $(this).serialize(); // Serialize form data
                $.ajax({
                  url: '{% url "register" %}', // Ensure this is the correct URL for handling registration
                  type: "POST",
                  data: formData,
                  success: function (response) {
                    // Check for a redirect URL in the response
                    if (response.redirect_url) {
                      // If registration is successful, dynamically load new page content into a container
                      $("#k1-article").load(response.redirect_url);
                    } else {
                      // If the response includes the updated form, replace the content
                      $("#k1-article").html(response);
                    }
                  },
                  error: function () {
                    alert("An error occurred. Please try again.");
                  },
                });
              });
            },
            error: function () {
              alert("Error loading registration form");
            },
          });
        });
      });
    </script>

    <script>
      $(document).ready(function () {
        $("#loadLoginForm").on("click", function (event) {
          event.preventDefault();
          $.ajax({
            url: '{% url "my-login" %}', // URL for the login form
            type: "GET",
            success: function (data) {
              $("#k1-article").html(data); // Load the login form content into the article

              // Attach a submit event listener to the dynamically loaded form
              $("#k1-article").on("submit", "form", function (e) {
                e.preventDefault();
                const formData = $(this).serialize(); // Serialize form data
                $.ajax({
                  url: '{% url "my-login" %}', // Ensure this is the correct URL for login processing
                  type: "POST",
                  data: formData,
                  success: function (response) {
                    // Check for a redirect URL in the response
                    if (response.redirect_url) {
                      // If login is successful, dynamically load new page content into a container
                      $("#k1-article").load(response.redirect_url);
                    } else {
                      // If the response includes the updated form, replace the content
                      $("#k1-article").html(response);
                    }
                  },
                  error: function () {
                    alert("An error occurred. Please try again.");
                  },
                });
              });
            },
            error: function () {
              alert("Error loading login form");
            },
          });
        });
      });
    </script>

    <script>
      $(document).ready(function () {
        // General function for loading forms dynamically
        function loadForm(url, container) {
          $.ajax({
            url: url, // URL for the form (either login or registration)
            type: "GET",
            success: function (data) {
              $(container).html(data); // Load the form content into the specified container
            },
            error: function () {
              alert("Error loading the form.");
            },
          });
        }

        // Attach click event listener for the "Register here" link dynamically
        $("#k1-article").on("click", "#registerLink", function (e) {
          e.preventDefault(); // Prevent default anchor behavior
          loadForm("{% url 'register' %}", "#k1-article"); // Load the registration form
        });

        // Attach click event listener for the "LogLink" (login link) dynamically
        $("#k1-article").on("click", "#LogLink", function (e) {
          e.preventDefault(); // Prevent default anchor behavior
          loadForm("{% url 'my-login' %}", "#k1-article"); // Load the login form
        });
      });
    </script>
  </body>
</html>